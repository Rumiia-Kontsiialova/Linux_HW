
В контексте инцидента, "post mortem" означает процесс анализа и оценки инцидента после того, как проблема была решена и работоспособность веб-сервиса восстановлена. Этот процесс направлен на изучение причин инцидента, выявление ошибок или недочетов, которые привели к сбою, и разработку мер для предотвращения подобных инцидентов в будущем.

В рамках учебного "post mortem" могут быть рассмотрены следующие вопросы и аспекты:

Причины инцидента

Предпринятые шаги для восстановления сервиса и устранения проблемы и полученные результаты

Формулирование рекомендаций и предложений по улучшению процессов

09:25 получилено сообщение об ошибка на сервере http://3.122.108.39/.

09:30 проверили,сервер не работает. на страничке высвечиваетсчя "$wgServer must be set in LocalSettings.php. See https://www.mediawiki.org/wiki/Manual:$wgServer." делаем вывод, что то с хранилищем и необходимо проверить файлик LocalSettings.php 

09:40 обращаемся к системному администратору для получения приватного клюбча, чтоб подключиться через терминал 

09:50 получили разрешения на 

10:00 заходим на сервер и проверяем статус через команду service httpd status 

10:10 перезапускаем сервер командой service httpd start, в ответ получаем ошибку невозможно перезапустить 

10:20 ищем файл, который показан как ошибка на странице браузера с помозью команды find / -type f -name "LocalSettings.php" 2>/dev/null 10:30 ыайл найден, просматриваем содрержимое с помощью коиманды cat /var/www/html/mediawiki/LocalSettings.php 

10:35 команда ничего не возвращает, также при попытке воспользоваться tab выдает ошибку, которая свидетельствует о том что закончилась оперативная память или в каком-то системном разделе нет места 

10:40 ппроверка сколько оперативной памяти free -h в человеческих единицах 

10:45 выяснено, что корневой раздел заполнен на 100% 

10:50 так как на странице браузера указана ошибкуа в определенный файл предпринимаю зайти внутрь файла и посмотреть возможно проблема в внутри файла. использщуем текстовый редактор 

10:55 фвйл LocalSettings.php пуст. 

11:00 делаем вывод что система не загружается потому что файл LocalSettings.php пуст, и также потому что закончилось место на жестком диске в корневом разделе 

11:00 описываем проблему системному администратору. Получаем информацию от системного администратора о том, что тв системе есть файл копия бэкапный файл LocalSettings.php с похожим названием и в нем содержится рабочая версия,из которого можно перезаписать информацию. 11:20 заходим в папку, где находится файл LocalSettings.php в поиске копии 

11:22 находим файл практически с таким же названием, однако пропущена буква а: LoclSettings.php и заходим внутрь с помощью текстового редактора 

11:25 берем информацию из LoclSettings.php и перезаписываем в LocalSettings.php. Получаем ошибку "No such file a directory" скорее всего ошибка из-за отствия места 

11:30 поптка копирования через команду ср с новым названием, то есть перезапишем и получаем также ошибку "No such file a directory" 

11:35 приянто решение удалить папку tmp для освобождения свободного места, чтоб хватило места для выполнения команды, 

11:50 прежде чем удалять необходимо посмотреть что находится tmp и сколько это весит. В результате проерки папка весит мало и не имеет смысла это удаление 

12:00 получили разрешение от системного администратора на ипользование команды sudo, чтоб смотреть больше, что есть у нас на системном диске 12:05 В результате проерки папка tmp весит мало и не имеет смысла это удаление 

12:10 принято решене искать все файлы с клбчевым словом "Local" в корневом разделе, пользуемся командой find / -name "Local" 2>/dev/null чтоб сбросить ошибки 

12:15 в разделе /home/ec2-user/ найден файл с клюбчевым словом, в папке присутсвует синтаксическая ошибка, будем использовать кавычки, чтоб система подумала что это условие, чтобы открыть используем nano "/home/ec2-user/LocalSettings (5).php" 

12:20 файл похож на бэкапный файл, которую мы искали. 

12:25 при попвтке перезаписать этот файл также высветилось ошибка свидельствующая о недостаточном месте

12:30 решаем найти громоздкие файлы в системе, чтоб проанализировать и возможно удалить не нужное.ищем во всем корне файл по рамезмеру более 50мб, пользуемся командой find / -type f -size +50M 2>/dev/null сбрасывач ошибки в "черную дыру" 

12:40 для уточнения данных выбираем команду файнд для поиска и готворим ей выполнить действие чтоб понять сколько точно веситть файлик, теперь ищем файлы больше 100мб и покажи сколько они занимают, ошибки сбросим в дыру find f -size +100M -exec du -h {} + 2>/dev/null 

12^45 найден локальный архив размером 108М принято решение удалить этот архив для освобождения места, пользуемся командой rm /usr/lib/locale/locale-archive 12:46 архив защищен, что означает что он крайне важен. Принято решение заглянуть внутрь архива и посмотреть на содержимое. ввожим команду tar -t /usr/lib/locale/locale-archive. В ответ снова ошибка 

12:50 по причине того, что мы сбросили все файлы с ошибками в черную дыру и мы как обычнй пользователь не мождем видеть многие системные файлы. Обращаемся к системному администратору за разрешением при сипользовании наших следующих комманд с помощью sudo 

13:10 получили разрешение на исипользование sudo и повторяем команду find f -size +100M -exec du -h {} + 2>/dev/null с sudo 13:02 благодаря режима супер администатора показалмя файл размером 7Гб в /var/log/httpd/access_log 

13:10 заходим внутрь файла, там оказывается много хаотичный символом, мусор 

13:15 не можм удалить файл, это мождет привести к сбою. требуется удалить содержание, при этом оставить. используем режим суперадминистратора и попробуем перезаписать файл, потому как при открытии этого файла через текстовый редактор - сервер может окончательно прекратить работу 

13:20 sudo echo "" > /var/log/httpd/access_log получаем ошибку Permission denied 

13:25 просим разрешения не на единоразовое использование, а навсю сессию в режме модератора sudo su .снова выполняем команду, но уже в режиме модератора find f -size +100M -exec du -h {} + 2>/dev/null 13:30 снова перезаписываем файл. Перезаписался успешно и выходим из режима модератора. 

13:45 в результате перезаписи файла размером 7гб мы освободили место. Прежде было занять 10 из 10ГБ сейчас 36% 

13:50 после проверки df -h_ также стали активны подсказки по tab, что свидетельствует о том, что сервер стал работать и отвечать на команды. Теперь мы можем перезаписать файл, который с синтаксической ошибкой в котором копия бэкэнда.Копируем с помощью команды cp и указываем полный к файлу где находятся наши глобальные настройки 

14:10 при помощи cat заходим в файл, чтобы проверить скопировался ли файл 


14:10 скопировано, однако веб браузер грузит и выдет ошибку "this site cant be readed" и ничего не отображает. а ранее выдавал ошибку 

14:20 проверяем статус с помощью servise start и обновляем страничку. видим, что ай пи адресс не совпадает. Срабатывает переадресация на адрес 18.153.51.162, возвращаемся в скоипрованный файл через текстовый редактор, чтобы проверить совпадают ли ай пи адреса. 

14:40 в переменной SwgServer указан 18.153.51.162 меняем его на 3.122.108.39 выходим с сохранением 

14:45 перезапускаем окно браузера и проверяем. Снова ошибка 14:50 перезапускаем httpd сервис с поощью sudo service httpd start 14:55 обновляем и заработало!